watch:
  js:
    before: 'watchify'
    watchers:
      - patterns: 'test/fixtures/scss'
        tasks: ['@sh echo "sass file edited"']

  default:
    before:
      - 'test/fixtures/tasks/bs.js'
    '*.json': ['test/fixtures/tasks/error.js', 'test/fixtures/tasks/observable.js']

tasks:

  watchify: >
    @bg watchify test/fixtures/js/app.js -o test/fixtures/js/app.watchify.js -v -d

  test:
    - compile
    - ci

  ci@p:
    - lint
    - unit

  compile: >
    @npm tsc
    src/**/*.ts
    --module commonjs
    --outDir dist

  lint:   '@npm eslint lib'
  unit:   '@npm mocha test'

  sleep@p:
    - sleep1
    - sleep2
    - sleep3
    - sleep4
    - slow-stream

  sleep1: ['@npm sleep', '@npm sleep 3']
  sleep2: '@npm sleep 1'
  sleep3: '@npm sleep 1'
  sleep4: '@npm sleep 1'

  slow-stream: 'test/fixtures/tasks/slow-stream.js'
